local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")

local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "ModernExecutorUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local Settings = {
	FPS = 60,
	Ping = 0,
	Graphics = 5,
	AntiScam = true,
	SavedScripts = {}
}

local function SaveSettings()
	pcall(function()
		writefile("ExecutorSettings.json", game:GetService("HttpService"):JSONEncode(Settings))
	end)
end

local function LoadSettings()
	pcall(function()
		if isfile("ExecutorSettings.json") then
			local data = readfile("ExecutorSettings.json")
			local decoded = game:GetService("HttpService"):JSONDecode(data)
			for k,v in pairs(decoded) do
				Settings[k] = v
			end
		end
	end)
end

LoadSettings()

local ConsoleOutput = {}
local function AddConsoleLog(text, color)
	table.insert(ConsoleOutput, {Text = text, Color = color or Color3.new(1,1,1), Time = os.date("%H:%M:%S")})
	if #ConsoleOutput > 100 then
		table.remove(ConsoleOutput, 1)
	end
end

-- ================= MAIN WINDOW =================
local mainWindow = Instance.new("Frame")
mainWindow.Parent = gui
mainWindow.Size = UDim2.fromScale(0.9,0.7)
mainWindow.Position = UDim2.fromScale(0.5,0.5)
mainWindow.AnchorPoint = Vector2.new(0.5,0.5)
mainWindow.BackgroundColor3 = Color3.fromRGB(15,15,15)
mainWindow.BorderSizePixel = 0
mainWindow.Visible = false
mainWindow.ZIndex = 5

Instance.new("UICorner", mainWindow).CornerRadius = UDim.new(0,15)

local mainStroke = Instance.new("UIStroke", mainWindow)
mainStroke.Color = Color3.fromRGB(40,40,40)
mainStroke.Thickness = 2

-- ================= TOP BAR =================
local topBar = Instance.new("Frame", mainWindow)
topBar.Size = UDim2.new(1,0,0,50)
topBar.BackgroundColor3 = Color3.fromRGB(20,20,20)
topBar.BorderSizePixel = 0
topBar.ZIndex = 6

Instance.new("UICorner", topBar).CornerRadius = UDim.new(0,15)

local topBarCover = Instance.new("Frame", topBar)
topBarCover.Size = UDim2.new(1,0,0.5,0)
topBarCover.Position = UDim2.fromScale(0,0.5)
topBarCover.BackgroundColor3 = Color3.fromRGB(20,20,20)
topBarCover.BorderSizePixel = 0
topBarCover.ZIndex = 6

local title = Instance.new("TextLabel", topBar)
title.Size = UDim2.new(0.7,0,1,0)
title.Position = UDim2.fromOffset(10,0)
title.Text = "Executor"
title.TextSize = 18
title.Font = Enum.Font.GothamBold
title.TextColor3 = Color3.fromRGB(255,255,255)
title.TextXAlignment = Enum.TextXAlignment.Left
title.BackgroundTransparency = 1
title.ZIndex = 7

local closeBtn = Instance.new("TextButton", topBar)
closeBtn.Size = UDim2.fromOffset(40,40)
closeBtn.Position = UDim2.new(1,-45,0.5,-20)
closeBtn.Text = "âœ•"
closeBtn.TextSize = 20
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.BackgroundColor3 = Color3.fromRGB(140,40,40)
closeBtn.BorderSizePixel = 0
closeBtn.ZIndex = 7

Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0,10)

closeBtn.MouseButton1Click:Connect(function()
	mainWindow.Visible = false
	AddConsoleLog("Executor closed", Color3.fromRGB(255,150,100))
end)

-- ================= TAB BUTTONS =================
local tabButtonsContainer = Instance.new("Frame", mainWindow)
tabButtonsContainer.Size = UDim2.new(1,0,0,50)
tabButtonsContainer.Position = UDim2.fromOffset(0,50)
tabButtonsContainer.BackgroundColor3 = Color3.fromRGB(18,18,18)
tabButtonsContainer.BorderSizePixel = 0
tabButtonsContainer.ZIndex = 6

local tabButtonsLayout = Instance.new("UIListLayout", tabButtonsContainer)
tabButtonsLayout.FillDirection = Enum.FillDirection.Horizontal
tabButtonsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
tabButtonsLayout.VerticalAlignment = Enum.VerticalAlignment.Center
tabButtonsLayout.Padding = UDim.new(0,5)

local activeTab = "Execution"
local tabButtons = {}
local tabContents = {}

local function CreateTabButton(name, icon)
	local btn = Instance.new("TextButton", tabButtonsContainer)
	btn.Size = UDim2.new(0.18,0,0,40)
	btn.Text = ""
	btn.BackgroundColor3 = Color3.fromRGB(25,25,25)
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	btn.ZIndex = 7
	
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)
	
	local iconLabel = Instance.new("TextLabel", btn)
	iconLabel.Size = UDim2.new(1,0,1,0)
	iconLabel.Text = icon
	iconLabel.TextSize = 18
	iconLabel.BackgroundTransparency = 1
	iconLabel.TextColor3 = Color3.fromRGB(120,120,120)
	iconLabel.ZIndex = 8
	
	tabButtons[name] = {Button = btn, Icon = iconLabel}
	
	btn.MouseButton1Click:Connect(function()
		activeTab = name
		for n, data in pairs(tabButtons) do
			if n == name then
				data.Button.BackgroundColor3 = Color3.fromRGB(50,120,200)
				data.Icon.TextColor3 = Color3.fromRGB(255,255,255)
			else
				data.Button.BackgroundColor3 = Color3.fromRGB(25,25,25)
				data.Icon.TextColor3 = Color3.fromRGB(120,120,120)
			end
		end
		for n, content in pairs(tabContents) do
			content.Visible = (n == name)
		end
	end)
	
	return btn
end

CreateTabButton("Execution", "ðŸ“Š")
CreateTabButton("Editor", "ðŸ“")
CreateTabButton("Scripts", "ðŸ’¾")
CreateTabButton("Console", "ðŸ’»")
CreateTabButton("Settings", "âš™ï¸")

-- ================= CONTENT AREA =================
local contentArea = Instance.new("Frame", mainWindow)
contentArea.Size = UDim2.new(1,-20,1,-120)
contentArea.Position = UDim2.fromOffset(10,110)
contentArea.BackgroundTransparency = 1
contentArea.ZIndex = 6

-- ================= EXECUTION TAB =================
local executionContent = Instance.new("ScrollingFrame", contentArea)
executionContent.Size = UDim2.new(1,0,1,0)
executionContent.BackgroundTransparency = 1
executionContent.BorderSizePixel = 0
executionContent.Visible = true
executionContent.ZIndex = 6
executionContent.ScrollBarThickness = 4
executionContent.ScrollBarImageColor3 = Color3.fromRGB(60,60,60)
tabContents["Execution"] = executionContent

local execLayout = Instance.new("UIListLayout", executionContent)
execLayout.Padding = UDim.new(0,10)
execLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local function CreateStatCard(name, icon)
	local card = Instance.new("Frame", executionContent)
	card.Size = UDim2.new(1,0,0,70)
	card.BackgroundColor3 = Color3.fromRGB(25,25,25)
	card.BorderSizePixel = 0
	card.ZIndex = 7
	
	Instance.new("UICorner", card).CornerRadius = UDim.new(0,12)
	
	local iconLabel = Instance.new("TextLabel", card)
	iconLabel.Size = UDim2.fromOffset(50,50)
	iconLabel.Position = UDim2.fromOffset(10,10)
	iconLabel.Text = icon
	iconLabel.TextSize = 30
	iconLabel.BackgroundTransparency = 1
	iconLabel.ZIndex = 8
	
	local nameLabel = Instance.new("TextLabel", card)
	nameLabel.Size = UDim2.new(1,-70,0,25)
	nameLabel.Position = UDim2.fromOffset(65,10)
	nameLabel.Text = name
	nameLabel.TextSize = 14
	nameLabel.Font = Enum.Font.GothamBold
	nameLabel.TextColor3 = Color3.fromRGB(150,150,150)
	nameLabel.TextXAlignment = Enum.TextXAlignment.Left
	nameLabel.BackgroundTransparency = 1
	nameLabel.ZIndex = 8
	
	local valueLabel = Instance.new("TextLabel", card)
	valueLabel.Size = UDim2.new(1,-70,0,30)
	valueLabel.Position = UDim2.fromOffset(65,35)
	valueLabel.Text = "0"
	valueLabel.TextSize = 20
	valueLabel.Font = Enum.Font.GothamBold
	valueLabel.TextColor3 = Color3.fromRGB(255,255,255)
	valueLabel.TextXAlignment = Enum.TextXAlignment.Left
	valueLabel.BackgroundTransparency = 1
	valueLabel.ZIndex = 8
	
	return valueLabel
end

local fpsValue = CreateStatCard("Frames Per Second", "ðŸŽ®")
local pingValue = CreateStatCard("Network Ping", "ðŸ“¡")
local graphicsValue = CreateStatCard("Graphics Quality", "âœ¨")

local playersCard = Instance.new("Frame", executionContent)
playersCard.Size = UDim2.new(1,0,0,200)
playersCard.BackgroundColor3 = Color3.fromRGB(25,25,25)
playersCard.BorderSizePixel = 0
playersCard.ZIndex = 7

Instance.new("UICorner", playersCard).CornerRadius = UDim.new(0,12)

local playersTitle = Instance.new("TextLabel", playersCard)
playersTitle.Size = UDim2.new(1,0,0,30)
playersTitle.Text = "ðŸ‘¥ Players in Game"
playersTitle.TextSize = 16
playersTitle.Font = Enum.Font.GothamBold
playersTitle.TextColor3 = Color3.fromRGB(255,255,255)
playersTitle.TextXAlignment = Enum.TextXAlignment.Center
playersTitle.BackgroundTransparency = 1
playersTitle.ZIndex = 8

local playersScroll = Instance.new("ScrollingFrame", playersCard)
playersScroll.Size = UDim2.new(1,-10,1,-40)
playersScroll.Position = UDim2.fromOffset(5,35)
playersScroll.BackgroundColor3 = Color3.fromRGB(20,20,20)
playersScroll.BorderSizePixel = 0
playersScroll.ZIndex = 8
playersScroll.ScrollBarThickness = 4
playersScroll.ScrollBarImageColor3 = Color3.fromRGB(60,60,60)

Instance.new("UICorner", playersScroll).CornerRadius = UDim.new(0,8)

local playersLayout = Instance.new("UIListLayout", playersScroll)
playersLayout.Padding = UDim.new(0,5)

local playersPadding = Instance.new("UIPadding", playersScroll)
playersPadding.PaddingTop = UDim.new(0,5)
playersPadding.PaddingLeft = UDim.new(0,5)
playersPadding.PaddingRight = UDim.new(0,5)

executionContent.CanvasSize = UDim2.new(0,0,0,execLayout.AbsoluteContentSize.Y + 10)

-- ================= EDITOR TAB =================
local editorContent = Instance.new("Frame", contentArea)
editorContent.Size = UDim2.new(1,0,1,0)
editorContent.BackgroundTransparency = 1
editorContent.Visible = false
editorContent.ZIndex = 6
tabContents["Editor"] = editorContent

local textBox = Instance.new("TextBox", editorContent)
textBox.Size = UDim2.new(1,0,1,-60)
textBox.Text = ""
textBox.PlaceholderText = "-- Tap here to write script..."
textBox.ClearTextOnFocus = false
textBox.TextWrapped = true
textBox.TextYAlignment = Enum.TextYAlignment.Top
textBox.TextXAlignment = Enum.TextXAlignment.Left
textBox.TextSize = 14
textBox.Font = Enum.Font.Code
textBox.TextColor3 = Color3.fromRGB(220,220,220)
textBox.BackgroundColor3 = Color3.fromRGB(25,25,25)
textBox.BorderSizePixel = 0
textBox.ZIndex = 7
textBox.MultiLine = true

Instance.new("UICorner", textBox).CornerRadius = UDim.new(0,12)

local textBoxPadding = Instance.new("UIPadding", textBox)
textBoxPadding.PaddingTop = UDim.new(0,10)
textBoxPadding.PaddingLeft = UDim.new(0,10)
textBoxPadding.PaddingRight = UDim.new(0,10)
textBoxPadding.PaddingBottom = UDim.new(0,10)

local buttonContainer = Instance.new("Frame", editorContent)
buttonContainer.Size = UDim2.new(1,0,0,55)
buttonContainer.Position = UDim2.new(0,0,1,-55)
buttonContainer.BackgroundTransparency = 1
buttonContainer.ZIndex = 6

local btnLayout = Instance.new("UIListLayout", buttonContainer)
btnLayout.FillDirection = Enum.FillDirection.Horizontal
btnLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center
btnLayout.VerticalAlignment = Enum.VerticalAlignment.Center
btnLayout.Padding = UDim.new(0,5)

local function CreateActionButton(text, color, callback)
	local btn = Instance.new("TextButton", buttonContainer)
	btn.Size = UDim2.new(0.23,0,0,45)
	btn.Text = text
	btn.TextSize = 13
	btn.Font = Enum.Font.GothamBold
	btn.TextColor3 = Color3.new(1,1,1)
	btn.BackgroundColor3 = color
	btn.BorderSizePixel = 0
	btn.ZIndex = 7
	
	Instance.new("UICorner", btn).CornerRadius = UDim.new(0,10)
	
	btn.MouseButton1Click:Connect(callback)
	
	return btn
end

CreateActionButton("â–¶ Execute", Color3.fromRGB(40,140,40), function()
	local source = textBox.Text
	if source == "" then 
		AddConsoleLog("Error: Empty script", Color3.fromRGB(255,150,0))
		return 
	end
	
	if Settings.AntiScam and (source:lower():find("robux") or source:lower():find("premium")) then
		AddConsoleLog("âš ï¸ Anti-Scam blocked", Color3.fromRGB(255,100,100))
		return
	end
	
	local fn, err = loadstring(source)
	if not fn then
		AddConsoleLog("Error: "..tostring(err), Color3.fromRGB(255,50,50))
		return
	end
	
	local success, runtimeErr = pcall(fn)
	if success then
		AddConsoleLog("âœ“ Executed", Color3.fromRGB(50,255,150))
	else
		AddConsoleLog("Error: "..tostring(runtimeErr), Color3.fromRGB(255,50,50))
	end
end)

CreateActionButton("ðŸ—‘ Clear", Color3.fromRGB(140,40,40), function()
	textBox.Text = ""
	AddConsoleLog("Cleared", Color3.fromRGB(150,150,255))
end)

CreateActionButton("ðŸ’¾ Save", Color3.fromRGB(40,100,180), function()
	if textBox.Text == "" then
		AddConsoleLog("Cannot save empty", Color3.fromRGB(255,150,0))
		return
	end
	table.insert(Settings.SavedScripts, {Name = "Script_"..#Settings.SavedScripts+1, Code = textBox.Text})
	SaveSettings()
	AddConsoleLog("âœ“ Saved", Color3.fromRGB(100,200,255))
end)

CreateActionButton("ðŸ“‹ Paste", Color3.fromRGB(80,80,140), function()
	pcall(function()
		textBox.Text = getclipboard() or ""
		AddConsoleLog("Pasted", Color3.fromRGB(150,200,255))
	end)
end)

-- ================= SCRIPTS TAB =================
local scriptsContent = Instance.new("Frame", contentArea)
scriptsContent.Size = UDim2.new(1,0,1,0)
scriptsContent.BackgroundTransparency = 1
scriptsContent.Visible = false
scriptsContent.ZIndex = 6
tabContents["Scripts"] = scriptsContent

local addScriptContainer = Instance.new("Frame", scriptsContent)
addScriptContainer.Size = UDim2.new(1,0,0,100)
addScriptContainer.BackgroundColor3 = Color3.fromRGB(25,25,25)
addScriptContainer.BorderSizePixel = 0
addScriptContainer.ZIndex = 7

Instance.new("UICorner", addScriptContainer).CornerRadius = UDim.new(0,12)

local nameInput = Instance.new("TextBox", addScriptContainer)
nameInput.Size = UDim2.new(1,-20,0,35)
nameInput.Position = UDim2.fromOffset(10,10)
nameInput.PlaceholderText = "Tap to name script..."
nameInput.Text = ""
nameInput.TextSize = 14
nameInput.Font = Enum.Font.Gotham
nameInput.TextColor3 = Color3.fromRGB(220,220,220)
nameInput.BackgroundColor3 = Color3.fromRGB(35,35,35)
nameInput.BorderSizePixel = 0
nameInput.ZIndex = 8
nameInput.ClearTextOnFocus = false

Instance.new("UICorner", nameInput).CornerRadius = UDim.new(0,8)

local addScriptBtn = Instance.new("TextButton", addScriptContainer)
addScriptBtn.Size = UDim2.new(1,-20,0,40)
addScriptBtn.Position = UDim2.fromOffset(10,50)
addScriptBtn.Text = "âž• Add Current Script"
addScriptBtn.TextSize = 14
addScriptBtn.Font = Enum.Font.GothamBold
addScriptBtn.TextColor3 = Color3.fromRGB(255,255,255)
addScriptBtn.BackgroundColor3 = Color3.fromRGB(40,120,200)
addScriptBtn.BorderSizePixel = 0
addScriptBtn.ZIndex = 8

Instance.new("UICorner", addScriptBtn).CornerRadius = UDim.new(0,10)

addScriptBtn.MouseButton1Click:Connect(function()
	if nameInput.Text ~= "" and textBox.Text ~= "" then
		table.insert(Settings.SavedScripts, {Name = nameInput.Text, Code = textBox.Text})
		SaveSettings()
		AddConsoleLog("âœ“ '"..nameInput.Text.."' saved", Color3.fromRGB(100,200,255))
		nameInput.Text = ""
	else
		AddConsoleLog("Need name and script", Color3.fromRGB(255,150,0))
	end
end)

local searchBox = Instance.new("TextBox", scriptsContent)
searchBox.Size = UDim2.new(1,0,0,40)
searchBox.Position = UDim2.fromOffset(0,110)
searchBox.PlaceholderText = "ðŸ” Tap to search..."
searchBox.Text = ""
searchBox.TextSize = 14
searchBox.Font = Enum.Font.Gotham
searchBox.TextColor3 = Color3.fromRGB(220,220,220)
searchBox.BackgroundColor3 = Color3.fromRGB(25,25,25)
searchBox.BorderSizePixel = 0
searchBox.ZIndex = 7
searchBox.ClearTextOnFocus = false

Instance.new("UICorner", searchBox).CornerRadius = UDim.new(0,12)

local scriptsScroll = Instance.new("ScrollingFrame", scriptsContent)
scriptsScroll.Size = UDim2.new(1,0,1,-160)
scriptsScroll.Position = UDim2.fromOffset(0,160)
scriptsScroll.BackgroundColor3 = Color3.fromRGB(25,25,25)
scriptsScroll.BorderSizePixel = 0
scriptsScroll.ZIndex = 7
scriptsScroll.ScrollBarThickness = 4
scriptsScroll.ScrollBarImageColor3 = Color3.fromRGB(60,60,60)

Instance.new("UICorner", scriptsScroll).CornerRadius = UDim.new(0,12)

local scriptsLayout = Instance.new("UIListLayout", scriptsScroll)
scriptsLayout.Padding = UDim.new(0,8)

local scriptsPadding = Instance.new("UIPadding", scriptsScroll)
scriptsPadding.PaddingTop = UDim.new(0,8)
scriptsPadding.PaddingLeft = UDim.new(0,8)
scriptsPadding.PaddingRight = UDim.new(0,8)

local function RefreshScripts()
	for _, child in pairs(scriptsScroll:GetChildren()) do
		if child:IsA("Frame") then child:Destroy() end
	end
	
	local searchTerm = searchBox.Text:lower()
	
	for i, script in ipairs(Settings.SavedScripts) do
		if searchTerm == "" or script.Name:lower():find(searchTerm) then
			local scriptFrame = Instance.new("Frame", scriptsScroll)
			scriptFrame.Size = UDim2.new(1,-10,0,60)
			scriptFrame.BackgroundColor3 = Color3.fromRGB(35,35,35)
			scriptFrame.BorderSizePixel = 0
			scriptFrame.ZIndex = 8
			
			Instance.new("UICorner", scriptFrame).CornerRadius = UDim.new(0,10)
			
			local scriptName = Instance.new("TextLabel", scriptFrame)
			scriptName.Size = UDim2.new(1,-130,1,0)
			scriptName.Position = UDim2.fromOffset(10,0)
			scriptName.Text = script.Name
			scriptName.TextSize = 14
			scriptName.Font = Enum.Font.GothamBold
			scriptName.TextColor3 = Color3.fromRGB(220,220,220)
			scriptName.TextXAlignment = Enum.TextXAlignment.Left
			scriptName.BackgroundTransparency = 1
			scriptName.ZIndex = 9
			
			local executeBtn = Instance.new("TextButton", scriptFrame)
			executeBtn.Size = UDim2.fromOffset(35,35)
			executeBtn.Position = UDim2.new(1,-115,0.5,-17.5)
			executeBtn.Text = "â–¶"
			executeBtn.TextSize = 16
			executeBtn.Font = Enum.Font.GothamBold
			executeBtn.TextColor3 = Color3.fromRGB(255,255,255)
			executeBtn.BackgroundColor3 = Color3.fromRGB(40,140,40)
			executeBtn.BorderSizePixel = 0
			executeBtn.ZIndex = 9
			
			Instance.new("UICorner", executeBtn).CornerRadius = UDim.new(0,8)
			
			executeBtn.MouseButton1Click:Connect(function()
				local fn, err = loadstring(script.Code)
				if fn then
					pcall(fn)
					AddConsoleLog("âœ“ Executed: "..script.Name, Color3.fromRGB(50,255,150))
				end
			end)
			
			local loadBtn = Instance.new("TextButton", scriptFrame)
			loadBtn.Size = UDim2.fromOffset(35,35)
			loadBtn.Position = UDim2.new(1,-75,0.5,-17.5)
			loadBtn.Text = "ðŸ“"
			loadBtn.TextSize = 16
			loadBtn.Font = Enum.Font.GothamBold
			loadBtn.TextColor3 = Color3.fromRGB(255,255,255)
			loadBtn.BackgroundColor3 = Color3.fromRGB(40,100,180)
			loadBtn.BorderSizePixel = 0
			loadBtn.ZIndex = 9
			
			Instance.new("UICorner", loadBtn).CornerRadius = UDim.new(0,8)
			
			loadBtn.MouseButton1Click:Connect(function()
				textBox.Text = script.Code
				activeTab = "Editor"
				tabButtons["Editor"].Button.BackgroundColor3 = Color3.fromRGB(50,120,200)
				tabButtons["Editor"].Icon.TextColor3 = Color3.fromRGB(255,255,255)
				for n, content in pairs(tabContents) do
					content.Visible = (n == "Editor")
				end
				AddConsoleLog("Loaded: "..script.Name, Color3.fromRGB(100,200,255))
			end)
			
			local deleteBtn = Instance.new("TextButton", scriptFrame)
			deleteBtn.Size = UDim2.fromOffset(35,35)
			deleteBtn.Position = UDim2.new(1,-35,0.5,-17.5)
			deleteBtn.Text = "ðŸ—‘"
			deleteBtn.TextSize = 16
			deleteBtn.Font = Enum.Font.GothamBold
			deleteBtn.TextColor3 = Color3.fromRGB(255,255,255)
			deleteBtn.BackgroundColor3 = Color3.fromRGB(140,40,40)
			deleteBtn.BorderSizePixel = 0
			deleteBtn.ZIndex = 9
			
			Instance.new("UICorner", deleteBtn).CornerRadius = UDim.new(0,8)
			
			deleteBtn.MouseButton1Click:Connect(function()
				table.remove(Settings.SavedScripts, i)
				SaveSettings()
				AddConsoleLog("Deleted: "..script.Name, Color3.fromRGB(255,100,100))
				RefreshScripts()
			end)
		end
	end
	
	scriptsScroll.CanvasSize = UDim2.new(0,0,0,scriptsLayout.AbsoluteContentSize.Y + 16)
end

searchBox:GetPropertyChangedSignal("Text"):Connect(RefreshScripts)

-- ================= CONSOLE TAB =================
local consoleContent = Instance.new("Frame", contentArea)
consoleContent.Size = UDim2.new(1,0,1,0)
consoleContent.BackgroundTransparency = 1
consoleContent.Visible = false
consoleContent.ZIndex = 6
tabContents["Console"] = consoleContent

local clearConsoleBtn = Instance.new("TextButton", consoleContent)
clearConsoleBtn.Size = UDim2.new(0.3,0,0,40)
clearConsoleBtn.Position = UDim2.new(0.35,0,0,0)
clearConsoleBtn.Text = "Clear Console"
clearConsoleBtn.TextSize = 13
clearConsoleBtn.Font = Enum.Font.GothamBold
clearConsoleBtn.TextColor3 = Color3.fromRGB(255,255,255)
clearConsoleBtn.BackgroundColor3 = Color3.fromRGB(140,40,40)
clearConsoleBtn.BorderSizePixel = 0
clearConsoleBtn.ZIndex = 8

Instance.new("UICorner", clearConsoleBtn).CornerRadius = UDim.new(0,10)

clearConsoleBtn.MouseButton1Click:Connect(function()
	ConsoleOutput = {}
	AddConsoleLog("Console cleared", Color3.fromRGB(150,150,255))
end)

local consoleScroll = Instance.new("ScrollingFrame", consoleContent)
consoleScroll.Size = UDim2.new(1,0,1,-50)
consoleScroll.Position = UDim2.fromOffset(0,50)
consoleScroll.BackgroundColor3 = Color3.fromRGB(20,20,20)
consoleScroll.BorderSizePixel = 0
consoleScroll.ZIndex = 7
consoleScroll.ScrollBarThickness = 4
consoleScroll.ScrollBarImageColor3 = Color3.fromRGB(60,60,60)

Instance.new("UICorner", consoleScroll).CornerRadius = UDim.new(0,12)

local consoleLayout = Instance.new("UIListLayout", consoleScroll)
consoleLayout.Padding = UDim.new(0,4)

local consolePadding = Instance.new("UIPadding", consoleScroll)
consolePadding.PaddingTop = UDim.new(0,8)
consolePadding.PaddingLeft = UDim.new(0,8)
consolePadding.PaddingRight = UDim.new(0,8)

-- ================= SETTINGS TAB =================
local settingsContent = Instance.new("ScrollingFrame", contentArea)
settingsContent.Size = UDim2.new(1,0,1,0)
settingsContent.BackgroundTransparency = 1
settingsContent.BorderSizePixel = 0
settingsContent.Visible = false
settingsContent.ZIndex = 6
settingsContent.ScrollBarThickness = 4
settingsContent.ScrollBarImageColor3 = Color3.fromRGB(60,60,60)
tabContents["Settings"] = settingsContent

local settingsLayout = Instance.new("UIListLayout", settingsContent)
settingsLayout.Padding = UDim.new(0,12)
settingsLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local function CreateToggle(name, desc, settingKey)
	local frame = Instance.new("Frame", settingsContent)
	frame.Size = UDim2.new(1,0,0,80)
	frame.BackgroundColor3 = Color3.fromRGB(25,25,25)
	frame.BorderSizePixel = 0
	frame.ZIndex = 7
	
	Instance.new("UICorner", frame).CornerRadius = UDim.new(0,12)
	
	local titleLabel = Instance.new("TextLabel", frame)
	titleLabel.Size = UDim2.new(1,-80,0,25)
	titleLabel.Position = UDim2.fromOffset(12,10)
	titleLabel.Text = name
	titleLabel.TextSize = 15
	titleLabel.Font = Enum.Font.GothamBold
	titleLabel.TextColor3 = Color3.fromRGB(255,255,255)
	titleLabel.TextXAlignment = Enum.TextXAlignment.Left
	titleLabel.BackgroundTransparency = 1
	titleLabel.ZIndex = 8
	
	local descLabel = Instance.new("TextLabel", frame)
	descLabel.Size = UDim2.new(1,-80,0,35)
	descLabel.Position = UDim2.fromOffset(12,35)
	descLabel.Text = desc
	descLabel.TextSize = 12
	descLabel.Font = Enum.Font.Gotham
	descLabel.TextColor3 = Color3.fromRGB(150,150,150)
	descLabel.TextXAlignment = Enum.TextXAlignment.Left
	descLabel.BackgroundTransparency = 1
	descLabel.ZIndex = 8
	descLabel.TextWrapped = true
	
	local toggleBtn = Instance.new("TextButton", frame)
	toggleBtn.Size = UDim2.fromOffset(55,30)
	toggleBtn.Position = UDim2.new(1,-65,0.5,-15)
	toggleBtn.Text = ""
	toggleBtn.BackgroundColor3 = Settings[settingKey] and Color3.fromRGB(40,140,40) or Color3.fromRGB(60,60,60)
	toggleBtn.BorderSizePixel = 0
	toggleBtn.ZIndex = 8
	
	Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1,0)
	
	local toggleCircle = Instance.new("Frame", toggleBtn)
	toggleCircle.Size = UDim2.fromOffset(24,24)
	toggleCircle.Position = Settings[settingKey] and UDim2.new(1,-27,0.5,-12) or UDim2.fromOffset(3,3)
	toggleCircle.BackgroundColor3 = Color3.fromRGB(255,255,255)
	toggleCircle.BorderSizePixel = 0
	toggleCircle.ZIndex = 9
	
	Instance.new("UICorner", toggleCircle).CornerRadius = UDim.new(1,0)
	
	toggleBtn.MouseButton1Click:Connect(function()
		Settings[settingKey] = not Settings[settingKey]
		SaveSettings()
		
		TweenService:Create(toggleBtn, TweenInfo.new(0.2), {
			BackgroundColor3 = Settings[settingKey] and Color3.fromRGB(40,140,40) or Color3.fromRGB(60,60,60)
		}):Play()
		
		TweenService:Create(toggleCircle, TweenInfo.new(0.2), {
			Position = Settings[settingKey] and UDim2.new(1,-27,0.5,-12) or UDim2.fromOffset(3,3)
		}):Play()
		
		AddConsoleLog(name.." "..(Settings[settingKey] and "enabled" or "disabled"), Color3.fromRGB(100,200,255))
	end)
end

CreateToggle("Anti-Scam Protection", "Blocks scripts that mention Robux or Premium", "AntiScam")

settingsContent.CanvasSize = UDim2.new(0,0,0,settingsLayout.AbsoluteContentSize.Y + 10)

-- ================= FLOATING BUTTON =================
local btn = Instance.new("TextButton")
btn.Parent = gui
btn.Size = UDim2.fromOffset(60,60)
btn.Position = UDim2.fromScale(0.5,0.1)
btn.AnchorPoint = Vector2.new(0.5,0.5)
btn.Text = "âš¡"
btn.TextSize = 30
btn.Font = Enum.Font.GothamBold
btn.TextColor3 = Color3.fromRGB(255,255,255)
btn.BackgroundColor3 = Color3.fromRGB(50,120,200)
btn.BorderSizePixel = 0
btn.AutoButtonColor = false
btn.ZIndex = 100

Instance.new("UICorner", btn).CornerRadius = UDim.new(1,0)

local btnStroke = Instance.new("UIStroke", btn)
btnStroke.Color = Color3.fromRGB(255,255,255)
btnStroke.Thickness = 3

local dragging = false
local dragInput, dragStart, startPos
local dragThreshold = 5
local hasMoved = false

btn.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragInput = input
		dragStart = input.Position
		startPos = btn.Position
		hasMoved = false
		
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
				if not hasMoved then
					mainWindow.Visible = not mainWindow.Visible
					if mainWindow.Visible then
						AddConsoleLog("âœ“ Executor opened", Color3.fromRGB(100,200,255))
					else
						AddConsoleLog("Executor closed", Color3.fromRGB(255,150,100))
					end
				end
			end
		end)
	end
end)

UIS.InputChanged:Connect(function(input)
	if dragging and input == dragInput then
		local delta = input.Position - dragStart
		if math.abs(delta.X) > dragThreshold or math.abs(delta.Y) > dragThreshold then
			hasMoved = true
			btn.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end
end)

-- ================= UPDATE SYSTEMS =================
local lastUpdate = tick()
local frameCount = 0

RunService.Heartbeat:Connect(function()
	frameCount = frameCount + 1
	
	if tick() - lastUpdate >= 1 then
		Settings.FPS = frameCount
		
		pcall(function()
			local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
			Settings.Ping = math.floor(ping)
		end)
		
		pcall(function()
			Settings.Graphics = game:GetService("UserSettings")():GetService("UserGameSettings").SavedQualityLevel
		end)
		
		fpsValue.Text = Settings.FPS.." FPS"
		pingValue.Text = Settings.Ping.." ms"
		graphicsValue.Text = "Level "..Settings.Graphics
		
		frameCount = 0
		lastUpdate = tick()
	end
end)

-- Update Players List
local function UpdatePlayersList()
	for _, child in pairs(playersScroll:GetChildren()) do
		if child:IsA("Frame") then
			child:Destroy()
		end
	end
	
	for _, plr in ipairs(Players:GetPlayers()) do
		local playerFrame = Instance.new("Frame", playersScroll)
		playerFrame.Size = UDim2.new(1,-10,0,40)
		playerFrame.BackgroundColor3 = Color3.fromRGB(30,30,30)
		playerFrame.BorderSizePixel = 0
		playerFrame.ZIndex = 9
		
		Instance.new("UICorner", playerFrame).CornerRadius = UDim.new(0,8)
		
		local playerName = Instance.new("TextLabel", playerFrame)
		playerName.Size = UDim2.new(1,-10,1,0)
		playerName.Position = UDim2.fromOffset(5,0)
		playerName.Text = plr.Name
		playerName.TextSize = 13
		playerName.Font = Enum.Font.Gotham
		playerName.TextColor3 = Color3.fromRGB(220,220,220)
		playerName.TextXAlignment = Enum.TextXAlignment.Left
		playerName.BackgroundTransparency = 1
		playerName.ZIndex = 10
	end
	
	playersScroll.CanvasSize = UDim2.new(0,0,0,playersLayout.AbsoluteContentSize.Y + 10)
end

Players.PlayerAdded:Connect(UpdatePlayersList)
Players.PlayerRemoving:Connect(UpdatePlayersList)
UpdatePlayersList()

-- Update Console
spawn(function()
	while wait(0.5) do
		for _, child in pairs(consoleScroll:GetChildren()) do
			if child:IsA("TextLabel") then
				child:Destroy()
			end
		end
		
		for i, log in ipairs(ConsoleOutput) do
			local logLabel = Instance.new("TextLabel", consoleScroll)
			logLabel.Size = UDim2.new(1,-10,0,25)
			logLabel.Text = "["..log.Time.."] "..log.Text
			logLabel.TextSize = 12
			logLabel.Font = Enum.Font.Code
			logLabel.TextColor3 = log.Color
			logLabel.TextXAlignment = Enum.TextXAlignment.Left
			logLabel.BackgroundColor3 = Color3.fromRGB(25,25,25)
			logLabel.BorderSizePixel = 0
			logLabel.ZIndex = 8
			
			Instance.new("UICorner", logLabel).CornerRadius = UDim.new(0,6)
		end
		
		consoleScroll.CanvasSize = UDim2.new(0,0,0,consoleLayout.AbsoluteContentSize.Y + 16)
	end
end)

-- Initial setup
tabButtons["Execution"].Button.BackgroundColor3 = Color3.fromRGB(50,120,200)
tabButtons["Execution"].Icon.TextColor3 = Color3.fromRGB(255,255,255)
AddConsoleLog("âœ“ Executor loaded", Color3.fromRGB(150,255,150))
RefreshScripts()
