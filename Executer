local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local MarketplaceService = game:GetService("MarketplaceService")

local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui")
gui.Name = "ModernExecutorUI"
gui.ResetOnSpawn = false
gui.Parent = player:WaitForChild("PlayerGui")

local Settings = {
	FPS = 60,
	Ping = 0,
	Graphics = 5,
	AntiScam = true,
	SavedScripts = {}
}

local function SaveSettings()
	pcall(function()
		writefile("ExecutorSettings.json", game:GetService("HttpService"):JSONEncode(Settings))
	end)
end

local function LoadSettings()
	pcall(function()
		if isfile("ExecutorSettings.json") then
			local data = readfile("ExecutorSettings.json")
			local decoded = game:GetService("HttpService"):JSONDecode(data)
			for k,v in pairs(decoded) do
				Settings[k] = v
			end
		end
	end)
end

LoadSettings()

local ConsoleOutput = {}
local function AddConsoleLog(text, logType)
	local colors = {
		print = Color3.fromRGB(200, 200, 200),
		warn = Color3.fromRGB(255, 200, 50),
		error = Color3.fromRGB(255, 80, 80),
		info = Color3.fromRGB(100, 200, 255),
		success = Color3.fromRGB(80, 255, 150)
	}
	
	table.insert(ConsoleOutput, {
		Text = text, 
		Color = colors[logType] or colors.print, 
		Time = os.date("%H:%M:%S"),
		Type = logType or "print"
	})
	
	if #ConsoleOutput > 200 then
		table.remove(ConsoleOutput, 1)
	end
end

-- Capture print, warn, error
local oldPrint = print
local oldWarn = warn
local oldError = error

getgenv().print = function(...)
	local args = {...}
	local str = table.concat(args, " ")
	AddConsoleLog(str, "print")
	oldPrint(...)
end

getgenv().warn = function(...)
	local args = {...}
	local str = table.concat(args, " ")
	AddConsoleLog(str, "warn")
	oldWarn(...)
end

getgenv().error = function(...)
	local args = {...}
	local str = table.concat(args, " ")
	AddConsoleLog(str, "error")
	-- Don't call oldError as it stops execution
end

-- Anti-Scam: Monitor purchase prompts
local promptConnection
if Settings.AntiScam then
	promptConnection = MarketplaceService.PromptProductPurchaseFinished:Connect(function()
		AddConsoleLog("âš ï¸ BLOCKED: Purchase prompt detected!", "warn")
	end)
	
	MarketplaceService.PromptPurchaseFinished:Connect(function()
		AddConsoleLog("âš ï¸ BLOCKED: Premium purchase prompt detected!", "warn")
	end)
end

-- ================= MAIN WINDOW =================
local mainWindow = Instance.new("Frame")
mainWindow.Parent = gui
mainWindow.Size = UDim2.fromScale(0.85, 0.75)
mainWindow.Position = UDim2.fromScale(0.5, 0.5)
mainWindow.AnchorPoint = Vector2.new(0.5, 0.5)
mainWindow.BackgroundColor3 = Color3.fromRGB(18, 18, 22)
mainWindow.BorderSizePixel = 0
mainWindow.Visible = false
mainWindow.ZIndex = 5

local mainCorner = Instance.new("UICorner", mainWindow)
mainCorner.CornerRadius = UDim.new(0, 16)

local mainStroke = Instance.new("UIStroke", mainWindow)
mainStroke.Color = Color3.fromRGB(60, 60, 80)
mainStroke.Thickness = 1

-- ================= SIDEBAR =================
local sidebar = Instance.new("Frame", mainWindow)
sidebar.Size = UDim2.new(0, 80, 1, 0)
sidebar.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
sidebar.BorderSizePixel = 0
sidebar.ZIndex = 6

local sidebarCorner = Instance.new("UICorner", sidebar)
sidebarCorner.CornerRadius = UDim.new(0, 16)

local sidebarCover = Instance.new("Frame", sidebar)
sidebarCover.Size = UDim2.new(1, 0, 1, 0)
sidebarCover.Position = UDim2.new(0, 20, 0, 0)
sidebarCover.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
sidebarCover.BorderSizePixel = 0
sidebarCover.ZIndex = 6

-- Logo
local logo = Instance.new("TextLabel", sidebar)
logo.Size = UDim2.new(1, 0, 0, 70)
logo.Text = "âš¡"
logo.TextSize = 32
logo.Font = Enum.Font.GothamBold
logo.TextColor3 = Color3.fromRGB(100, 150, 255)
logo.BackgroundTransparency = 1
logo.ZIndex = 7

local tabButtonsContainer = Instance.new("Frame", sidebar)
tabButtonsContainer.Size = UDim2.new(1, 0, 1, -150)
tabButtonsContainer.Position = UDim2.fromOffset(0, 80)
tabButtonsContainer.BackgroundTransparency = 1
tabButtonsContainer.ZIndex = 7

local tabLayout = Instance.new("UIListLayout", tabButtonsContainer)
tabLayout.Padding = UDim.new(0, 8)
tabLayout.HorizontalAlignment = Enum.HorizontalAlignment.Center

local activeTab = "Home"
local tabButtons = {}
local tabContents = {}

local function CreateSidebarButton(name, icon)
	local btn = Instance.new("TextButton", tabButtonsContainer)
	btn.Size = UDim2.new(0, 60, 0, 60)
	btn.Text = ""
	btn.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
	btn.BorderSizePixel = 0
	btn.AutoButtonColor = false
	btn.ZIndex = 8
	
	local corner = Instance.new("UICorner", btn)
	corner.CornerRadius = UDim.new(0, 12)
	
	local iconLabel = Instance.new("TextLabel", btn)
	iconLabel.Size = UDim2.new(1, 0, 1, 0)
	iconLabel.Text = icon
	iconLabel.TextSize = 24
	iconLabel.BackgroundTransparency = 1
	iconLabel.TextColor3 = Color3.fromRGB(120, 120, 140)
	iconLabel.ZIndex = 9
	
	local indicator = Instance.new("Frame", btn)
	indicator.Size = UDim2.new(0, 3, 0, 30)
	indicator.Position = UDim2.new(0, -8, 0.5, -15)
	indicator.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
	indicator.BorderSizePixel = 0
	indicator.Visible = false
	indicator.ZIndex = 9
	
	local indCorner = Instance.new("UICorner", indicator)
	indCorner.CornerRadius = UDim.new(1, 0)
	
	tabButtons[name] = {Button = btn, Icon = iconLabel, Indicator = indicator}
	
	btn.MouseButton1Click:Connect(function()
		activeTab = name
		for n, data in pairs(tabButtons) do
			if n == name then
				data.Button.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
				data.Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
				data.Indicator.Visible = true
			else
				data.Button.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
				data.Icon.TextColor3 = Color3.fromRGB(120, 120, 140)
				data.Indicator.Visible = false
			end
		end
		for n, content in pairs(tabContents) do
			content.Visible = (n == name)
		end
	end)
	
	return btn
end

CreateSidebarButton("Home", "ðŸ ")
CreateSidebarButton("Editor", "ðŸ’»")
CreateSidebarButton("Scripts", "ðŸ“¦")
CreateSidebarButton("Console", "ðŸ“Š")
CreateSidebarButton("Settings", "âš™ï¸")

-- Close button at bottom
local closeBtn = Instance.new("TextButton", sidebar)
closeBtn.Size = UDim2.new(0, 60, 0, 60)
closeBtn.Position = UDim2.new(0.5, -30, 1, -70)
closeBtn.Text = "âœ•"
closeBtn.TextSize = 24
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextColor3 = Color3.fromRGB(255, 100, 100)
closeBtn.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
closeBtn.BorderSizePixel = 0
closeBtn.ZIndex = 8

local closeCorner = Instance.new("UICorner", closeBtn)
closeCorner.CornerRadius = UDim.new(0, 12)

closeBtn.MouseButton1Click:Connect(function()
	mainWindow.Visible = false
	AddConsoleLog("Executor closed", "info")
end)

-- ================= CONTENT AREA =================
local contentArea = Instance.new("Frame", mainWindow)
contentArea.Size = UDim2.new(1, -100, 1, -30)
contentArea.Position = UDim2.fromOffset(90, 15)
contentArea.BackgroundTransparency = 1
contentArea.ZIndex = 6

-- ================= HOME TAB =================
local homeContent = Instance.new("ScrollingFrame", contentArea)
homeContent.Size = UDim2.new(1, 0, 1, 0)
homeContent.BackgroundTransparency = 1
homeContent.BorderSizePixel = 0
homeContent.Visible = true
homeContent.ZIndex = 6
homeContent.ScrollBarThickness = 6
homeContent.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 80)
tabContents["Home"] = homeContent

local homeLayout = Instance.new("UIListLayout", homeContent)
homeLayout.Padding = UDim.new(0, 15)
homeLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left

local homeTitle = Instance.new("TextLabel", homeContent)
homeTitle.Size = UDim2.new(1, 0, 0, 40)
homeTitle.Text = "Dashboard"
homeTitle.TextSize = 28
homeTitle.Font = Enum.Font.GothamBold
homeTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
homeTitle.TextXAlignment = Enum.TextXAlignment.Left
homeTitle.BackgroundTransparency = 1
homeTitle.ZIndex = 7

local statsGrid = Instance.new("Frame", homeContent)
statsGrid.Size = UDim2.new(1, 0, 0, 250)
statsGrid.BackgroundTransparency = 1
statsGrid.ZIndex = 7

local gridLayout = Instance.new("UIGridLayout", statsGrid)
gridLayout.CellSize = UDim2.new(0.32, 0, 0, 110)
gridLayout.CellPadding = UDim2.new(0.01, 0, 0, 15)

local function CreateStatCard(parent, title, icon)
	local card = Instance.new("Frame", parent)
	card.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
	card.BorderSizePixel = 0
	card.ZIndex = 8
	
	local corner = Instance.new("UICorner", card)
	corner.CornerRadius = UDim.new(0, 12)
	
	local iconLabel = Instance.new("TextLabel", card)
	iconLabel.Size = UDim2.fromOffset(40, 40)
	iconLabel.Position = UDim2.fromOffset(15, 15)
	iconLabel.Text = icon
	iconLabel.TextSize = 28
	iconLabel.BackgroundTransparency = 1
	iconLabel.ZIndex = 9
	
	local titleLabel = Instance.new("TextLabel", card)
	titleLabel.Size = UDim2.new(1, -20, 0, 20)
	titleLabel.Position = UDim2.fromOffset(10, 60)
	titleLabel.Text = title
	titleLabel.TextSize = 11
	titleLabel.Font = Enum.Font.Gotham
	titleLabel.TextColor3 = Color3.fromRGB(140, 140, 160)
	titleLabel.TextXAlignment = Enum.TextXAlignment.Left
	titleLabel.BackgroundTransparency = 1
	titleLabel.ZIndex = 9
	
	local valueLabel = Instance.new("TextLabel", card)
	valueLabel.Size = UDim2.new(1, -20, 0, 28)
	valueLabel.Position = UDim2.fromOffset(10, 78)
	valueLabel.Text = "0"
	valueLabel.TextSize = 22
	valueLabel.Font = Enum.Font.GothamBold
	valueLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	valueLabel.TextXAlignment = Enum.TextXAlignment.Left
	valueLabel.BackgroundTransparency = 1
	valueLabel.ZIndex = 9
	
	return valueLabel
end

local fpsValue = CreateStatCard(statsGrid, "FPS", "ðŸŽ®")
local pingValue = CreateStatCard(statsGrid, "PING", "ðŸ“¡")
local graphicsValue = CreateStatCard(statsGrid, "GRAPHICS", "âœ¨")
local playersValue = CreateStatCard(statsGrid, "PLAYERS", "ðŸ‘¥")
local serverValue = CreateStatCard(statsGrid, "SERVER", "ðŸŒ")
local uptimeValue = CreateStatCard(statsGrid, "UPTIME", "â±ï¸")

local startTime = tick()

homeContent.CanvasSize = UDim2.new(0, 0, 0, homeLayout.AbsoluteContentSize.Y + 20)

-- ================= EDITOR TAB =================
local editorContent = Instance.new("Frame", contentArea)
editorContent.Size = UDim2.new(1, 0, 1, 0)
editorContent.BackgroundTransparency = 1
editorContent.Visible = false
editorContent.ZIndex = 6
tabContents["Editor"] = editorContent

local editorTitle = Instance.new("TextLabel", editorContent)
editorTitle.Size = UDim2.new(1, 0, 0, 35)
editorTitle.Text = "Script Editor"
editorTitle.TextSize = 24
editorTitle.Font = Enum.Font.GothamBold
editorTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
editorTitle.TextXAlignment = Enum.TextXAlignment.Left
editorTitle.BackgroundTransparency = 1
editorTitle.ZIndex = 7

local textBoxContainer = Instance.new("Frame", editorContent)
textBoxContainer.Size = UDim2.new(1, 0, 1, -100)
textBoxContainer.Position = UDim2.fromOffset(0, 45)
textBoxContainer.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
textBoxContainer.BorderSizePixel = 0
textBoxContainer.ZIndex = 7

local textCorner = Instance.new("UICorner", textBoxContainer)
textCorner.CornerRadius = UDim.new(0, 12)

local textBox = Instance.new("TextBox", textBoxContainer)
textBox.Size = UDim2.new(1, -20, 1, -20)
textBox.Position = UDim2.fromOffset(10, 10)
textBox.Text = ""
textBox.PlaceholderText = "-- Write your script here..."
textBox.ClearTextOnFocus = false
textBox.TextWrapped = true
textBox.TextYAlignment = Enum.TextYAlignment.Top
textBox.TextXAlignment = Enum.TextXAlignment.Left
textBox.TextSize = 14
textBox.Font = Enum.Font.Code
textBox.TextColor3 = Color3.fromRGB(220, 220, 220)
textBox.BackgroundTransparency = 1
textBox.BorderSizePixel = 0
textBox.ZIndex = 8
textBox.MultiLine = true

local buttonContainer = Instance.new("Frame", editorContent)
buttonContainer.Size = UDim2.new(1, 0, 0, 50)
buttonContainer.Position = UDim2.new(0, 0, 1, -50)
buttonContainer.BackgroundTransparency = 1
buttonContainer.ZIndex = 6

local btnLayout = Instance.new("UIListLayout", buttonContainer)
btnLayout.FillDirection = Enum.FillDirection.Horizontal
btnLayout.HorizontalAlignment = Enum.HorizontalAlignment.Left
btnLayout.VerticalAlignment = Enum.VerticalAlignment.Center
btnLayout.Padding = UDim.new(0, 10)

local function CreateActionButton(text, icon, color, callback)
	local btn = Instance.new("TextButton", buttonContainer)
	btn.Size = UDim2.new(0.23, 0, 0, 45)
	btn.Text = ""
	btn.BackgroundColor3 = color
	btn.BorderSizePixel = 0
	btn.ZIndex = 7
	
	local corner = Instance.new("UICorner", btn)
	corner.CornerRadius = UDim.new(0, 10)
	
	local iconLabel = Instance.new("TextLabel", btn)
	iconLabel.Size = UDim2.fromOffset(20, 20)
	iconLabel.Position = UDim2.fromOffset(12, 13)
	iconLabel.Text = icon
	iconLabel.TextSize = 16
	iconLabel.BackgroundTransparency = 1
	iconLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	iconLabel.ZIndex = 8
	
	local textLabel = Instance.new("TextLabel", btn)
	textLabel.Size = UDim2.new(1, -40, 1, 0)
	textLabel.Position = UDim2.fromOffset(35, 0)
	textLabel.Text = text
	textLabel.TextSize = 13
	textLabel.Font = Enum.Font.GothamBold
	textLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	textLabel.TextXAlignment = Enum.TextXAlignment.Left
	textLabel.BackgroundTransparency = 1
	textLabel.ZIndex = 8
	
	btn.MouseButton1Click:Connect(callback)
	
	return btn
end

CreateActionButton("Execute", "â–¶", Color3.fromRGB(60, 180, 80), function()
	local source = textBox.Text
	if source == "" then 
		AddConsoleLog("Cannot execute empty script", "warn")
		return 
	end
	
	if Settings.AntiScam then
		local lower = source:lower()
		if lower:find("robux") or lower:find("premium") or lower:find("marketplace") or 
		   lower:find("promptpurchase") or lower:find("promptproductpurchase") then
			AddConsoleLog("âš ï¸ BLOCKED: Script contains purchase-related keywords!", "error")
			return
		end
	end
	
	local fn, err = loadstring(source)
	if not fn then
		AddConsoleLog("Syntax Error: "..tostring(err), "error")
		return
	end
	
	local success, runtimeErr = pcall(fn)
	if success then
		AddConsoleLog("âœ“ Script executed successfully", "success")
	else
		AddConsoleLog("Runtime Error: "..tostring(runtimeErr), "error")
	end
end)

CreateActionButton("Clear", "ðŸ—‘", Color3.fromRGB(200, 60, 60), function()
	textBox.Text = ""
	AddConsoleLog("Editor cleared", "info")
end)

CreateActionButton("Paste", "ðŸ“‹", Color3.fromRGB(100, 120, 200), function()
	local success, clipboard = pcall(function()
		return getclipboard()
	end)
	if success and clipboard then
		textBox.Text = clipboard
		AddConsoleLog("Pasted from clipboard", "info")
	else
		AddConsoleLog("Failed to paste from clipboard", "warn")
	end
end)

-- ================= SCRIPTS TAB =================
local scriptsContent = Instance.new("Frame", contentArea)
scriptsContent.Size = UDim2.new(1, 0, 1, 0)
scriptsContent.BackgroundTransparency = 1
scriptsContent.Visible = false
scriptsContent.ZIndex = 6
tabContents["Scripts"] = scriptsContent

local scriptsTitle = Instance.new("TextLabel", scriptsContent)
scriptsTitle.Size = UDim2.new(1, 0, 0, 35)
scriptsTitle.Text = "Saved Scripts"
scriptsTitle.TextSize = 24
scriptsTitle.Font = Enum.Font.GothamBold
scriptsTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
scriptsTitle.TextXAlignment = Enum.TextXAlignment.Left
scriptsTitle.BackgroundTransparency = 1
scriptsTitle.ZIndex = 7

local saveContainer = Instance.new("Frame", scriptsContent)
saveContainer.Size = UDim2.new(1, 0, 0, 100)
saveContainer.Position = UDim2.fromOffset(0, 45)
saveContainer.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
saveContainer.BorderSizePixel = 0
saveContainer.ZIndex = 7

local saveCorner = Instance.new("UICorner", saveContainer)
saveCorner.CornerRadius = UDim.new(0, 12)

local nameInput = Instance.new("TextBox", saveContainer)
nameInput.Size = UDim2.new(1, -20, 0, 35)
nameInput.Position = UDim2.fromOffset(10, 10)
nameInput.PlaceholderText = "Enter script name..."
nameInput.Text = ""
nameInput.TextSize = 14
nameInput.Font = Enum.Font.Gotham
nameInput.TextColor3 = Color3.fromRGB(220, 220, 220)
nameInput.BackgroundColor3 = Color3.fromRGB(40, 40, 50)
nameInput.BorderSizePixel = 0
nameInput.ZIndex = 8
nameInput.ClearTextOnFocus = false

local nameCorner = Instance.new("UICorner", nameInput)
nameCorner.CornerRadius = UDim.new(0, 8)

local saveBtn = Instance.new("TextButton", saveContainer)
saveBtn.Size = UDim2.new(1, -20, 0, 40)
saveBtn.Position = UDim2.fromOffset(10, 50)
saveBtn.Text = "ðŸ’¾ Save Current Script"
saveBtn.TextSize = 14
saveBtn.Font = Enum.Font.GothamBold
saveBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
saveBtn.BackgroundColor3 = Color3.fromRGB(60, 180, 80)
saveBtn.BorderSizePixel = 0
saveBtn.ZIndex = 8

local saveBtnCorner = Instance.new("UICorner", saveBtn)
saveBtnCorner.CornerRadius = UDim.new(0, 10)

saveBtn.MouseButton1Click:Connect(function()
	if nameInput.Text ~= "" and textBox.Text ~= "" then
		local scriptName = nameInput.Text
		local scriptCode = textBox.Text
		
		-- Check if name already exists
		local exists = false
		for i, script in ipairs(Settings.SavedScripts) do
			if script.Name == scriptName then
				exists = true
				Settings.SavedScripts[i].Code = scriptCode
				break
			end
		end
		
		if not exists then
			table.insert(Settings.SavedScripts, {Name = scriptName, Code = scriptCode})
		end
		
		SaveSettings()
		AddConsoleLog("âœ“ Script '"..scriptName.."' saved successfully", "success")
		nameInput.Text = ""
		task.wait(0.1)
		RefreshScripts()
	else
		AddConsoleLog("Please enter a name and write a script first", "warn")
	end
end)

local searchBox = Instance.new("TextBox", scriptsContent)
searchBox.Size = UDim2.new(1, 0, 0, 40)
searchBox.Position = UDim2.fromOffset(0, 155)
searchBox.PlaceholderText = "ðŸ” Search scripts..."
searchBox.Text = ""
searchBox.TextSize = 14
searchBox.Font = Enum.Font.Gotham
searchBox.TextColor3 = Color3.fromRGB(220, 220, 220)
searchBox.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
searchBox.BorderSizePixel = 0
searchBox.ZIndex = 7
searchBox.ClearTextOnFocus = false

local searchCorner = Instance.new("UICorner", searchBox)
searchCorner.CornerRadius = UDim.new(0, 12)

local searchPadding = Instance.new("UIPadding", searchBox)
searchPadding.PaddingLeft = UDim.new(0, 15)

local scriptsScroll = Instance.new("ScrollingFrame", scriptsContent)
scriptsScroll.Size = UDim2.new(1, 0, 1, -205)
scriptsScroll.Position = UDim2.fromOffset(0, 205)
scriptsScroll.BackgroundColor3 = Color3.fromRGB(25, 25, 30)
scriptsScroll.BorderSizePixel = 0
scriptsScroll.ZIndex = 7
scriptsScroll.ScrollBarThickness = 6
scriptsScroll.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 80)

local scrollCorner = Instance.new("UICorner", scriptsScroll)
scrollCorner.CornerRadius = UDim.new(0, 12)

local scriptsLayout = Instance.new("UIListLayout", scriptsScroll)
scriptsLayout.Padding = UDim.new(0, 10)

local scriptsPadding = Instance.new("UIPadding", scriptsScroll)
scriptsPadding.PaddingTop = UDim.new(0, 10)
scriptsPadding.PaddingLeft = UDim.new(0, 10)
scriptsPadding.PaddingRight = UDim.new(0, 10)
scriptsPadding.PaddingBottom = UDim.new(0, 10)

function RefreshScripts()
	for _, child in pairs(scriptsScroll:GetChildren()) do
		if child:IsA("Frame") then child:Destroy() end
	end
	
	local searchTerm = searchBox.Text:lower()
	
	for i, script in ipairs(Settings.SavedScripts) do
		if searchTerm == "" or script.Name:lower():find(searchTerm) then
			local scriptFrame = Instance.new("Frame", scriptsScroll)
			scriptFrame.Size = UDim2.new(1, -10, 0, 70)
			scriptFrame.BackgroundColor3 = Color3.fromRGB(35, 35, 45)
			scriptFrame.BorderSizePixel = 0
			scriptFrame.ZIndex = 8
			
			local scriptCorner = Instance.new("UICorner", scriptFrame)
			scriptCorner.CornerRadius = UDim.new(0, 10)
			
			local scriptIcon = Instance.new("TextLabel", scriptFrame)
			scriptIcon.Size = UDim2.fromOffset(50, 50)
			scriptIcon.Position = UDim2.fromOffset(10, 10)
			scriptIcon.Text = "ðŸ“„"
			scriptIcon.TextSize = 28
			scriptIcon.BackgroundTransparency = 1
			scriptIcon.ZIndex = 9
			
			local scriptName = Instance.new("TextLabel", scriptFrame)
			scriptName.Size = UDim2.new(1, -200, 0, 25)
			scriptName.Position = UDim2.fromOffset(70, 12)
			scriptName.Text = script.Name
			scriptName.TextSize = 15
			scriptName.Font = Enum.Font.GothamBold
			scriptName.TextColor3 = Color3.fromRGB(220, 220, 220)
			scriptName.TextXAlignment = Enum.TextXAlignment.Left
			scriptName.BackgroundTransparency = 1
			scriptName.ZIndex = 9
			
			local scriptInfo = Instance.new("TextLabel", scriptFrame)
			scriptInfo.Size = UDim2.new(1, -200, 0, 20)
			scriptInfo.Position = UDim2.fromOffset(70, 38)
			scriptInfo.Text = #script.Code.." characters"
			scriptInfo.TextSize = 12
			scriptInfo.Font = Enum.Font.Gotham
			scriptInfo.TextColor3 = Color3.fromRGB(140, 140, 160)
			scriptInfo.TextXAlignment = Enum.TextXAlignment.Left
			scriptInfo.BackgroundTransparency = 1
			scriptInfo.ZIndex = 9
			
			local function CreateScriptButton(pos, icon, color, callback)
				local btn = Instance.new("TextButton", scriptFrame)
				btn.Size = UDim2.fromOffset(40, 40)
				btn.Position = UDim2.new(1, pos, 0.5, -20)
				btn.Text = icon
				btn.TextSize = 18
				btn.Font = Enum.Font.GothamBold
				btn.TextColor3 = Color3.fromRGB(255, 255, 255)
				btn.BackgroundColor3 = color
				btn.BorderSizePixel = 0
				btn.ZIndex = 9
				
				Instance.new("UICorner", btn).CornerRadius = UDim.new(0, 8)
				
				btn.MouseButton1Click:Connect(callback)
			end
			
			CreateScriptButton(-125, "â–¶", Color3.fromRGB(60, 180, 80), function()
				local fn, err = loadstring(script.Code)
				if fn then
					pcall(fn)
					AddConsoleLog("âœ“ Executed: "..script.Name, "success")
				else
					AddConsoleLog("Error in "..script.Name..": "..tostring(err), "error")
				end
			end)
			
			CreateScriptButton(-80, "ðŸ“", Color3.fromRGB(100, 120, 200), function()
				textBox.Text = script.Code
				activeTab = "Editor"
				for n, data in pairs(tabButtons) do
					data.Button.BackgroundColor3 = n == "Editor" and Color3.fromRGB(100, 150, 255) or Color3.fromRGB(30, 30, 38)
					data.Icon.TextColor3 = n == "Editor" and Color3.fromRGB(255, 255, 255) or Color3.fromRGB(120, 120, 140)
					data.Indicator.Visible = n == "Editor"
				end
				for n, content in pairs(tabContents) do
					content.Visible = n == "Editor"
				end
				AddConsoleLog("Loaded: "..script.Name, "info")
			end)
			
			CreateScriptButton(-35, "ðŸ—‘", Color3.fromRGB(200, 60, 60), function()
				table.remove(Settings.SavedScripts, i)
				SaveSettings()
				AddConsoleLog("Deleted: "..script.Name, "warn")
				RefreshScripts()
			end)
		end
	end
	
	scriptsScroll.CanvasSize = UDim2.new(0, 0, 0, scriptsLayout.AbsoluteContentSize.Y + 20)
end

searchBox:GetPropertyChangedSignal("Text"):Connect(RefreshScripts)

-- ================= CONSOLE TAB =================
local consoleContent = Instance.new("Frame", contentArea)
consoleContent.Size = UDim2.new(1, 0, 1, 0)
consoleContent.BackgroundTransparency = 1
consoleContent.Visible = false
consoleContent.ZIndex = 6
tabContents["Console"] = consoleContent

local consoleTitle = Instance.new("TextLabel", consoleContent)
consoleTitle.Size = UDim2.new(1, 0, 0, 35)
consoleTitle.Text = "Console Output"
consoleTitle.TextSize = 24
consoleTitle.Font = Enum.Font.GothamBold
consoleTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
consoleTitle.TextXAlignment = Enum.TextXAlignment.Left
consoleTitle.BackgroundTransparency = 1
consoleTitle.ZIndex = 7

local clearConsoleBtn = Instance.new("TextButton", consoleContent)
clearConsoleBtn.Size = UDim2.new(0, 120, 0, 40)
clearConsoleBtn.Position = UDim2.fromOffset(0, 45)
clearConsoleBtn.Text = "ðŸ—‘ Clear Console"
clearConsoleBtn.TextSize = 13
clearConsoleBtn.Font = Enum.Font.GothamBold
clearConsoleBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
clearConsoleBtn.BackgroundColor3 = Color3.fromRGB(200, 60, 60)
clearConsoleBtn.BorderSizePixel = 0
clearConsoleBtn.ZIndex = 8

Instance.new("UICorner", clearConsoleBtn).CornerRadius = UDim.new(0, 10)

clearConsoleBtn.MouseButton1Click:Connect(function()
	ConsoleOutput = {}
	AddConsoleLog("Console cleared", "info")
end)

local consoleScroll = Instance.new("ScrollingFrame", consoleContent)
consoleScroll.Size = UDim2.new(1, 0, 1, -95)
consoleScroll.Position = UDim2.fromOffset(0, 95)
consoleScroll.BackgroundColor3 = Color3.fromRGB(20, 20, 25)
consoleScroll.BorderSizePixel = 0
consoleScroll.ZIndex = 7
consoleScroll.ScrollBarThickness = 6
consoleScroll.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 80)

Instance.new("UICorner", consoleScroll).CornerRadius = UDim.new(0, 12)

local consoleLayout = Instance.new("UIListLayout", consoleScroll)
consoleLayout.Padding = UDim.new(0, 5)

local consolePadding = Instance.new("UIPadding", consoleScroll)
consolePadding.PaddingTop = UDim.new(0, 10)
consolePadding.PaddingLeft = UDim.new(0, 10)
consolePadding.PaddingRight = UDim.new(0, 10)
consolePadding.PaddingBottom = UDim.new(0, 10)

-- ================= SETTINGS TAB =================
local settingsContent = Instance.new("ScrollingFrame", contentArea)
settingsContent.Size = UDim2.new(1, 0, 1, 0)
settingsContent.BackgroundTransparency = 1
settingsContent.BorderSizePixel = 0
settingsContent.Visible = false
settingsContent.ZIndex = 6
settingsContent.ScrollBarThickness = 6
settingsContent.ScrollBarImageColor3 = Color3.fromRGB(60, 60, 80)
tabContents["Settings"] = settingsContent

local settingsLayout = Instance.new("UIListLayout", settingsContent)
settingsLayout.Padding = UDim.new(0, 15)

local settingsTitle = Instance.new("TextLabel", settingsContent)
settingsTitle.Size = UDim2.new(1, 0, 0, 35)
settingsTitle.Text = "Settings"
settingsTitle.TextSize = 24
settingsTitle.Font = Enum.Font.GothamBold
settingsTitle.TextColor3 = Color3.fromRGB(255, 255, 255)
settingsTitle.TextXAlignment = Enum.TextXAlignment.Left
settingsTitle.BackgroundTransparency = 1
settingsTitle.ZIndex = 7

local function CreateToggle(name, desc, settingKey)
	local frame = Instance.new("Frame", settingsContent)
	frame.Size = UDim2.new(1, 0, 0, 90)
	frame.BackgroundColor3 = Color3.fromRGB(30, 30, 38)
	frame.BorderSizePixel = 0
	frame.ZIndex = 7
	
	Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 12)
	
	local titleLabel = Instance.new("TextLabel", frame)
	titleLabel.Size = UDim2.new(1, -80, 0, 25)
	titleLabel.Position = UDim2.fromOffset(15, 15)
	titleLabel.Text = name
	titleLabel.TextSize = 16
	titleLabel.Font = Enum.Font.GothamBold
	titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
	titleLabel.TextXAlignment = Enum.TextXAlignment.Left
	titleLabel.BackgroundTransparency = 1
	titleLabel.ZIndex = 8
	
	local descLabel = Instance.new("TextLabel", frame)
	descLabel.Size = UDim2.new(1, -80, 0, 40)
	descLabel.Position = UDim2.fromOffset(15, 40)
	descLabel.Text = desc
	descLabel.TextSize = 13
	descLabel.Font = Enum.Font.Gotham
	descLabel.TextColor3 = Color3.fromRGB(150, 150, 170)
	descLabel.TextXAlignment = Enum.TextXAlignment.Left
	descLabel.BackgroundTransparency = 1
	descLabel.ZIndex = 8
	descLabel.TextWrapped = true
	
	local toggleBtn = Instance.new("TextButton", frame)
	toggleBtn.Size = UDim2.fromOffset(60, 32)
	toggleBtn.Position = UDim2.new(1, -70, 0, 15)
	toggleBtn.Text = ""
	toggleBtn.BackgroundColor3 = Settings[settingKey] and Color3.fromRGB(60, 180, 80) or Color3.fromRGB(60, 60, 70)
	toggleBtn.BorderSizePixel = 0
	toggleBtn.ZIndex = 8
	
	Instance.new("UICorner", toggleBtn).CornerRadius = UDim.new(1, 0)
	
	local toggleCircle = Instance.new("Frame", toggleBtn)
	toggleCircle.Size = UDim2.fromOffset(26, 26)
	toggleCircle.Position = Settings[settingKey] and UDim2.new(1, -29, 0.5, -13) or UDim2.fromOffset(3, 3)
	toggleCircle.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
	toggleCircle.BorderSizePixel = 0
	toggleCircle.ZIndex = 9
	
	Instance.new("UICorner", toggleCircle).CornerRadius = UDim.new(1, 0)
	
	toggleBtn.MouseButton1Click:Connect(function()
		Settings[settingKey] = not Settings[settingKey]
		SaveSettings()
		
		TweenService:Create(toggleBtn, TweenInfo.new(0.2), {
			BackgroundColor3 = Settings[settingKey] and Color3.fromRGB(60, 180, 80) or Color3.fromRGB(60, 60, 70)
		}):Play()
		
		TweenService:Create(toggleCircle, TweenInfo.new(0.2), {
			Position = Settings[settingKey] and UDim2.new(1, -29, 0.5, -13) or UDim2.fromOffset(3, 3)
		}):Play()
		
		AddConsoleLog(name.." "..(Settings[settingKey] and "enabled" or "disabled"), "info")
	end)
end

CreateToggle("Anti-Scam Protection", "Blocks scripts with purchase-related keywords and monitors for purchase prompts", "AntiScam")

settingsContent.CanvasSize = UDim2.new(0, 0, 0, settingsLayout.AbsoluteContentSize.Y + 20)

-- ================= FLOATING BUTTON =================
local floatBtn = Instance.new("TextButton")
floatBtn.Parent = gui
floatBtn.Size = UDim2.fromOffset(65, 65)
floatBtn.Position = UDim2.fromScale(0.9, 0.1)
floatBtn.AnchorPoint = Vector2.new(0.5, 0.5)
floatBtn.Text = "âš¡"
floatBtn.TextSize = 32
floatBtn.Font = Enum.Font.GothamBold
floatBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
floatBtn.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
floatBtn.BorderSizePixel = 0
floatBtn.AutoButtonColor = false
floatBtn.ZIndex = 100

Instance.new("UICorner", floatBtn).CornerRadius = UDim.new(1, 0)

local btnStroke = Instance.new("UIStroke", floatBtn)
btnStroke.Color = Color3.fromRGB(70, 100, 200)
btnStroke.Thickness = 3

local dragging = false
local dragInput, dragStart, startPos
local dragThreshold = 5
local hasMoved = false

floatBtn.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.Touch or input.UserInputType == Enum.UserInputType.MouseButton1 then
		dragging = true
		dragInput = input
		dragStart = input.Position
		startPos = floatBtn.Position
		hasMoved = false
		
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
				if not hasMoved then
					mainWindow.Visible = not mainWindow.Visible
					if mainWindow.Visible then
						AddConsoleLog("âœ“ Executor opened", "info")
					end
				end
			end
		end)
	end
end)

UIS.InputChanged:Connect(function(input)
	if dragging and input == dragInput then
		local delta = input.Position - dragStart
		if math.abs(delta.X) > dragThreshold or math.abs(delta.Y) > dragThreshold then
			hasMoved = true
			floatBtn.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
		end
	end
end)

-- ================= UPDATE SYSTEMS =================
local lastUpdate = tick()
local frameCount = 0

RunService.Heartbeat:Connect(function()
	frameCount = frameCount + 1
	
	if tick() - lastUpdate >= 1 then
		Settings.FPS = frameCount
		
		pcall(function()
			local ping = game:GetService("Stats").Network.ServerStatsItem["Data Ping"]:GetValue()
			Settings.Ping = math.floor(ping)
		end)
		
		pcall(function()
			Settings.Graphics = game:GetService("UserSettings")():GetService("UserGameSettings").SavedQualityLevel
		end)
		
		fpsValue.Text = Settings.FPS.." FPS"
		pingValue.Text = Settings.Ping.." ms"
		graphicsValue.Text = "Level "..Settings.Graphics
		playersValue.Text = #Players:GetPlayers()
		serverValue.Text = game.JobId:sub(1, 8)
		
		local uptime = math.floor(tick() - startTime)
		local hours = math.floor(uptime / 3600)
		local minutes = math.floor((uptime % 3600) / 60)
		local seconds = uptime % 60
		uptimeValue.Text = string.format("%02d:%02d:%02d", hours, minutes, seconds)
		
		frameCount = 0
		lastUpdate = tick()
	end
end)

-- Update Console Display
spawn(function()
	while wait(0.5) do
		for _, child in pairs(consoleScroll:GetChildren()) do
			if child:IsA("TextLabel") then
				child:Destroy()
			end
		end
		
		for i, log in ipairs(ConsoleOutput) do
			local logLabel = Instance.new("TextLabel", consoleScroll)
			logLabel.Size = UDim2.new(1, -10, 0, 30)
			logLabel.Text = "["..log.Time.."] ["..log.Type:upper().."] "..log.Text
			logLabel.TextSize = 13
			logLabel.Font = Enum.Font.Code
			logLabel.TextColor3 = log.Color
			logLabel.TextXAlignment = Enum.TextXAlignment.Left
			logLabel.BackgroundColor3 = Color3.fromRGB(28, 28, 35)
			logLabel.BorderSizePixel = 0
			logLabel.ZIndex = 8
			logLabel.TextWrapped = true
			
			Instance.new("UICorner", logLabel).CornerRadius = UDim.new(0, 6)
			
			local padding = Instance.new("UIPadding", logLabel)
			padding.PaddingLeft = UDim.new(0, 8)
			padding.PaddingRight = UDim.new(0, 8)
		end
		
		consoleScroll.CanvasSize = UDim2.new(0, 0, 0, consoleLayout.AbsoluteContentSize.Y + 20)
		consoleScroll.CanvasPosition = Vector2.new(0, consoleScroll.CanvasSize.Y.Offset)
	end
end)

-- Initial setup
tabButtons["Home"].Button.BackgroundColor3 = Color3.fromRGB(100, 150, 255)
tabButtons["Home"].Icon.TextColor3 = Color3.fromRGB(255, 255, 255)
tabButtons["Home"].Indicator.Visible = true
AddConsoleLog("âœ“ Executor loaded successfully", "success")
RefreshScripts()
